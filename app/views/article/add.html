<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>{{ title }}</title>
    <meta name="keywords" content="node开发,node ide,js桌面软件开发" />
    <meta name="description" content="node ide jsIDE开发平台" />
    {% include "./app/views/header-inc.html" %}
  </head>
  <body>
      {# %- include('../header.html', {channel:'blog'}) #}      
      {% include "./app/views/header.html" %}
      <div class="main">
          <div class="box">
              <form action="" method="POST">
                  
  <div data-toggle="buttons">
  <label class="btn btn-secondary active">
    <input type="checkbox" checked autocomplete="off">标签(选中)</label>
  </label>
  <label class="btn btn-secondary">
    <input type="checkbox" autocomplete="off"> Checkbox 2</label>
  </label>
  <label class="btn btn-secondary">
    <input type="checkbox" autocomplete="off"> Checkbox 3</label>
  </label>
</div>
                  <input type="hidden" name="id" value='{{ _id }}'/>
  <div class="form-group row">
    <label class="col-sm-1 form-control-label">标题</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" name="title" value='{{ title }}'>
    </div>
  </div>
  <div class="form-group row">
    <label class="col-sm-1 form-control-label">标签</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" name="tags" value='{{ tags }}'>
    </div>
  </div>
  <div class="form-group row">
    <label class="col-sm-1 form-control-label">摘要</label>
    <div class="col-sm-10">
      <textarea type="text" class="form-control" name="excerpt" >{{ excerpt }}</textarea>
    </div>
  </div>
  <div class="form-group row" style="display:none;">
    <div class="col-sm-offset-1 col-sm-10">
        <textarea name="markdown" class="markdown">{{ markdown }}</textarea>
        <textarea name="html">{{ html }}</textarea>
    </div>
  </div>
  <div class="form-group row">
    <div class="col-sm-offset-1 col-sm-10">
      <button type="submit" class="btn btn-success">保存</button>
    </div>
  </div>
              </form>
              <iframe id='editormd' width="100%" height="560" src="/third-party/editor.html" frameborder="0"></iframe>
          </div>
      </div>
      {% include './app/views/footer.html' %}
      {% include "./app/views/footer-inc.html" %}
      <script>
          $(function(){
              window.getMarkdown = function(){
                  return $('form textarea[name=markdown]').val();
              }
            //   var md = $('form textarea[name=markdown]').val();
            //   document.getElementById("editormd").contentWindow.setMarkdown(md);
          });
              
          $(function(){
              $('form').submit(function(e){
                //e.preventDefault() 
                var html = document.getElementById("editormd").contentWindow.getHtml();
                $('form textarea[name=html]').val(html);
                var md = document.getElementById("editormd").contentWindow.getMarkdown();
                $('form textarea[name=markdown]').val(md);                
                //document.getElementById("editormd").contentWindow.setMarkdown(html);
                //alert('提交submit\r\n' + html);
              });
            //   $('#submit').click(function(){
            //       alert('提交');
            //       //$('form').submit();
            //   });
          });
      </script>
  </body>
</html>
